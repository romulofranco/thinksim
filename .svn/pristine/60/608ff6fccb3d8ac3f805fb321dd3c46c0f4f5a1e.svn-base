package br.unicamp.fe.thinksim.entity;

import java.io.Serializable;

import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.Id;
import javax.persistence.Table;
import javax.persistence.Temporal;
import javax.persistence.TemporalType;
import javax.persistence.Transient;


@Entity
@Table(name = "users")
public class User implements Serializable {

	private static final long serialVersionUID = 1L;
	public static final String ACTIVE_YES = "1";
	public static final String ACTIVE_NO = "0";

	public static final String MUDAR_SENHA_SIM = "s";
	public static final String MUDAR_SENHA_NAO = "n";

	@Id
	private String username;

	@Column
	private String password = this.generatePwd();

	@Column
	private String name = "";

	@Column
	private String email = "";

	@Column(name = "nivel_permissao")
	private Integer nivelPermissao = 1;

	@Column
	private String foto = "";

	@Temporal(TemporalType.TIMESTAMP)
	@Column(name = "date_time")
	private java.util.Date dateTime;

	@Column
	private String active = User.ACTIVE_YES;

	@Column
	private String mobilidade = User.ACTIVE_NO;

	@Column(name = "theme")
	private String theme = "bootstrap";

	@Column(name = "sidebarcolor")
	private String sideBarColor = "blue";

	@Column(name = "pwd_logon")
	private String mudarSenha;

	@Column(name = "nivel_permissao_reg")
	private Integer nivelPermissaoReg;

	@Column(name = "permissao")
	private String permissao;

	@Column(name = "username_owner")
	private String usernameOwner;

	@Transient
	private String img;

	public String getUsername() {
		return username;
	}

	public void setUsername(String username) {
		this.username = username;
	}

	public String getPassword() {
		return password;
	}

	public void setPassword(String password) {
		this.password = password;
	}

	public String getName() {
		return name;
	}

	public void setName(String name) {
		this.name = name;
	}

	public Integer getNivelPermissao() {
		return nivelPermissao;
	}

	public void setNivelPermissao(Integer nivelPermissao) {
		this.nivelPermissao = nivelPermissao;
	}

	public java.util.Date getDateTime() {
		return dateTime;
	}

	public void setDateTime(java.util.Date dateTime) {
		this.dateTime = dateTime;
	}

	public String getActive() {
		return active;
	}

	public void setActive(String active) {
		this.active = active;
	}

	public String getImg() {
		if (active.equals(ACTIVE_YES)) {
			return "images/green.png";
		} else {
			return "images/red.png";
		}
	}

	public void setImg(String img) {
		this.img = img;
	}

	public String getEmail() {
		return email;
	}

	public void setEmail(String email) {
		this.email = email;
	}

	public String generatePwd() {
		String[] carct = { "0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "a", "b", "c", "d", "e", "f", "g", "h",
				"i", "j", "k", "l", "m", "n", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y", "z", "A", "B", "C",
				"D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X",
				"Y", "Z" };

		String password = "";

		for (int x = 0; x < 10; x++) {
			int j = (int) (Math.random() * carct.length);
			password += carct[j];

		}

		return password;
	}

	public String getTheme() {
		return theme;
	}

	public void setTheme(String theme) {
		this.theme = theme;
	}

	public String getSideBarColor() {
		return sideBarColor;
	}

	public void setSideBarColor(String sideBarColor) {
		this.sideBarColor = sideBarColor;
	}

	public String getFoto() {
		if (this.foto == null) {
			if (username.endsWith("a")) {
				return "user-f.png";
			} else {
				return "user-m.png";
			}
		}
		if (this.foto.isEmpty()) {
			if (username.endsWith("a")) {
				return "user-f.png";
			} else {
				return "user-m.png";
			}
		}

		return this.foto;
	}

	public void setFoto(String foto) {
		this.foto = foto;
	}

	public String getTypeStr() {
		if (this.nivelPermissao == EntityModel.NIVEL_PERMISSAO_TIPO_ADMIN) {
			return "admin";
		} else if (this.nivelPermissao == EntityModel.NIVEL_PERMISSAO_TIPO_USUARIO) {
			return "Usuário";
		} else if (this.nivelPermissao == EntityModel.NIVEL_PERMISSAO_TIPO_TECNICO) {
			return "Técnico";
		} else if (this.nivelPermissao == EntityModel.NIVEL_PERMISSAO_TIPO_CLIENTE) {
			return "Cliente";
		}

		return "Usuário";
	}

	public String getTypeImg() {
		if (this.nivelPermissao == EntityModel.NIVEL_PERMISSAO_TIPO_ADMIN) {
			return "images/admin1.png";
		} else if (this.nivelPermissao == EntityModel.NIVEL_PERMISSAO_TIPO_USUARIO) {
			return "images/user2.png";
		} else if (this.nivelPermissao == EntityModel.NIVEL_PERMISSAO_TIPO_TECNICO) {
			return "images/worker.png";
		} else if (this.nivelPermissao == EntityModel.NIVEL_PERMISSAO_TIPO_CLIENTE) {
			return "images/cliente1.png";
		}

		return "images/user2.png";
	}

	@Override
	public String toString() {
		return "User [username=" + username + ", password=" + password + ", name=" + name + ", email=" + email
				+ ", nivelPermissao=" + nivelPermissao + ", dateTime=" + dateTime + ", active=" + active + ", theme="
				+ theme + ", sideBarColor=" + sideBarColor + "]";
	}

	

	public String getMudarSenha() {
		return mudarSenha;
	}

	public void setMudarSenha(String mudarSenha) {
		this.mudarSenha = mudarSenha;
	}

	public String toJson() {
		StringBuilder sb = new StringBuilder();
		sb.append("{");
		sb.append("'username':'").append(this.getUsername()).append("','nome':'").append(this.name).append("','tipo':'")
				.append(this.nivelPermissao).append("','email':'").append(this.email).append("','foto':'")
				.append(this.foto).append("'}");
		return sb.toString();
	}

	public Integer getNivelPermissaoReg() {
		return nivelPermissaoReg;
	}

	public void setNivelPermissaoReg(Integer nivelPermissao) {
		this.nivelPermissaoReg = nivelPermissao;
	}

	public String getPermissao() {
		return permissao;
	}

	public void setPermissao(String permissao) {
		this.permissao = permissao;
	}

	public String getUsernameOwner() {
		return usernameOwner;
	}

	public void setUsernameOwner(String username) {
		this.usernameOwner = username;
	}

	public String getMobilidade() {
		return mobilidade;
	}

	public void setMobilidade(String mobilidade) {
		this.mobilidade = mobilidade;
	}

}
